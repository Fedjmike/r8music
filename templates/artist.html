{% extends "layout.html" %}
{% from "release_list.html" import release_list, release_grid %}

{% block title %}{{ artist.name }} {{ super() }}{% endblock %}

{% block content %}
<section class="content page">
    <div class="clearfix">
        {% set thumb, image = artist.get_image() %}
        {% if image %}
            <a href={{ image }}><img class="artist-image" src={{ thumb }}></a>
        {% endif %}
        
        <header><h1>{{ artist.name }}</h1></header>
        
        {% set description = artist.get_description() %}
        <p>{{ description | safe if description else "" }}</p>
        
        {% set wp_urls = artist.get_wikipedia_urls() %}
        {% if wp_urls %}
            {% set wp_page, wp_edit = wp_urls %}
            <p class="de-emph">[<a href="{{ wp_page }}" target=_blank>Read more</a> or <a href="{{ wp_edit }}" target=_blank>edit</a> on Wikipedia]</p>
        {% endif %}
    </div>
    
    {% set albums = artist.get_releases() | selectattr("release_type", "equalto", "Album") | list %}
    {% if albums %}
</section>
<section class="content page">
    <header><h2>Albums</h2></header>
    {{ release_grid(albums | sort(attribute="date"), user) }}
</section>
<section class="content page">
    {% endif %}
    
    {% set others = artist.get_releases() | rejectattr("release_type", "equalto", "Album") | list %}
    {% if others %}
        <header><h3>Other releases</h3></header>
        {{ release_grid(others | sort(attribute="date"), user, "small") }}
    {% endif %}
</section>
{% endblock %}